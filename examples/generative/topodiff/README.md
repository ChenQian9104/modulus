# TopoDiff
We propose Topodiff, a conditional diffusion-model-based architecture to perform performance-aware and manufacturability-aware topology optimization that overcomes the issues of Generative Adversarial Networks (GANs) such as difficult to train, limited generalizability and neglecting manufacturability. Topodiff introduces a surrogate model-based guidance strategy that actively favors structures with low compliance and good manufacturability.
- Link to the paper: [Link](https://arxiv.org/abs/2208.09591)
- Link to the project: [Link](https://decode.mit.edu/projects/topodiff/)

<p align="center">
<img src="../../../docs/img/topodiff_doc/topodiff.png" width="840" />
</p>

## Dataset
Link to the dataset: [here](https://www.dropbox.com/home/decode_lab/Datasets/Public%20Documents/Topodiff_dataset)
Download the dataset and set the **path_data** in [text](conf/config.yaml)

## Instructions 
2D topology structures could be generated by Topodiff conditioned on the boundary and loading conditions. A few examples are shown below: 
<p align="center">
<img src="../../../docs/img/topodiff_doc/topology_generated.png" width="840" />
</p>

### Model training 
Run the following command to train the diffusion model, classifier for floating material and regressor for compliance:
```Bash
python examples/generative/topodiff/train.py
python examples/generative/topodiff/train_classifier.py
python examples/generative/topodiff/train_regressor.py
```
### Generation
Run the following command to generate topologies: 
```Bash
python examples/generative/topodiff/inference.py
```




## Citations
To cite this work, please use the following reference:

```bibtex
@inproceedings{maze2023diffusion,
  title={Diffusion models beat gans on topology optimization},
  author={Maz{\'e}, Fran{\c{c}}ois and Ahmed, Faez},
  booktitle={Proceedings of the AAAI conference on artificial intelligence},
  volume={37},
  number={8},
  pages={9108--9116},
  year={2023}
}
```

## Contacts 

